Act as a Senior Linux Systems Developer and React Expert. I need you to scaffold a **Cockpit Project Plugin** to manage "Demo Deployments."

**Context:**
- **Goal:** Users deploy demos defined in Ansible Collections.
- **Collections:** Collections can be installed via `ansible-galaxy collection install` using standard Ansible tooling, or loaded from locally installed collections in standard Ansible locations. Each collection contains a special `demos.yaml` file in its root describing the available demos and their input parameters.
- **Local Collections:** The plugin supports loading collections from standard Ansible collection paths (e.g., `~/.ansible/collections`, `/usr/share/ansible/collections`) in addition to the plugin-specific directory.
- **Persistence:** Filesystem-based (Split-File pattern) in `/var/lib/cockpit-plugin-demos/`.
- **Execution:** Ansible playbooks are executed via `ansible-navigator` triggered by `systemd-run`. The command output is displayed in the web UI.
- **Execution Environment:** Configuration must be provided to define the execution environment (EE) used by `ansible-navigator`. The EE must include `ansible-galaxy` command for collection installation when needed.

**Security:**
- Plugin runs as a standard user (member of `cockpit-demo-ops` group).
- NO `sudo` in code.

**Directory Structure (CRITICAL):**
To ensure Ansible can use collections installed via standard tooling, the plugin must maintain this Host structure:

```text
/var/lib/cockpit-plugin-demos/
  ├── collections/              <-- Plugin-specific Ansible collections directory
  │   └── ansible_collections/
  │       └── <namespace>/
  │           └── <collection>/ <-- Installed via ansible-galaxy collection install
  │               ├── MANIFEST.json
  │               ├── demos.yaml  <-- Demo definitions for this collection
  │               ├── playbooks/
  │               └── roles/
  ├── meta/
  │   ├── meta_playbook.yml  <-- Main meta playbook for execution
  │   └── ansible.cfg        <-- Ansible configuration with collections_paths
  └── instances/
      └── <instance-id>/
          ├── spec.json
          └── status.json
```

**Local Collections:**
Collections may also be loaded from standard Ansible collection paths:
- `~/.ansible/collections/ansible_collections/` (user-specific)
- `/usr/share/ansible/collections/` (system-wide)
- Paths configured in system `ansible.cfg` or `ANSIBLE_COLLECTIONS_PATHS` environment variable

The plugin checks these locations in addition to the plugin-specific directory when loading collections.

**Requirements:**

1.  **Data Models (`src/lib/types.ts`):**
    - `DemoParameter`: { name: string, label?: string, description?: string, type: 'text' | 'number' | 'boolean' | 'select', required: boolean, options?: string[], default?: any }
    - `DemoDefinition`: { id: string, name: string, description?: string, type: 'playbook', path: string, parameters: DemoParameter[] }
    - `CatalogConfig`: { collectionSource?: string, namespace?: string, collectionName?: string, executionEnvironment?: string, useLocalCollection?: boolean }
      - `collectionSource`: Git repository URL (`git+https://...`) or Ansible Galaxy format (`namespace.collection`). Required if `useLocalCollection` is false.
      - `namespace`: Optional. Automatically derived from `MANIFEST.json` file in the collection repository. Should not be manually set.
      - `collectionName`: Optional. Automatically derived from `MANIFEST.json` file in the collection repository (from the `collection_info.name` field). Should not be manually set.
      - `useLocalCollection`: If true, load collection from locally installed locations instead of installing. Defaults to false.
    - `InstanceSpec`: Includes demoType, demoPath, and variable_definitions array
    - `InstanceStatus`: Includes optional summary field with collected_info array

2.  **Catalog Service (`src/lib/catalog.ts`):**
    - `syncCatalog(config)`:
      - If `useLocalCollection` is true, skips installation and searches for collection in local Ansible collection paths.
      - Otherwise, executes `ansible-galaxy collection install` command in the execution environment using `cockpit.spawn`.
      - Supports both Git repository URLs (`git+https://...`) and Ansible Galaxy format (`namespace.collection`).
      - After installation, reads `MANIFEST.json` from the installed collection to extract `namespace` and `name` (collection name) fields from `collection_info`.
      - If `namespace` or `collectionName` are not provided in config, they are automatically derived from the `MANIFEST.json` file.
      - Uses `--collections-path /var/lib/cockpit-plugin-demos/collections` flag to install to plugin directory when installing.
      - Ensures collections directory structure follows Ansible standard layout: `collections/ansible_collections/{namespace}/{collectionName}`.
      - Creates `ansible.cfg` in meta directory with multiple `collections_paths` (plugin directory and standard locations) if it doesn't exist.
    - `findCollectionPath(namespace, collectionName)`:
      - Searches for collection in multiple locations in order:
        1. Plugin-specific: `/var/lib/cockpit-plugin-demos/collections/ansible_collections/{namespace}/{collectionName}`
        2. User-specific: `~/.ansible/collections/ansible_collections/{namespace}/{collectionName}`
        3. System-wide: `/usr/share/ansible/collections/ansible_collections/{namespace}/{collectionName}`
      - Returns the first path where the collection is found, or null if not found.
    - `readManifestMetadata(collectionPath)`:
      - Reads `MANIFEST.json` file from the collection path.
      - Extracts `namespace` and `name` (collection name) fields from the `collection_info` object in the JSON file.
      - Returns an object with `namespace` and `collectionName` properties.
      - Used to automatically populate namespace and collection name when not provided in config.
    - `getDemos()`:
      - Uses `findCollectionPath()` to locate the collection.
      - Reads `demos.yaml` from the found collection location: `{collectionPath}/demos.yaml`.
      - Returns `DemoDefinition[]`.
    - `getVariableDefinitions()`:
      - Generates variable definitions array for meta playbook validation.

3.  **Instance Service (`src/lib/instances.ts`):**
    - `createInstance(demoId, formData)`:
      - Generates ID.
      - Writes `spec.json` to `instances/<id>/`.
      - **Important:** `spec.json` must include `demoType`, `demoPath`, `playbook_path`, and `variable_definitions`.
    - `executeInstance(instanceId, executionEnvironment)`:
      - Calls meta playbook (`/var/lib/cockpit-plugin-demos/meta/meta_playbook.yml`) instead of direct playbook.
      - Passes `instance_id`, `demo_type`, `demo_path`, `demo_vars`, and `variable_definitions` as extra-vars.
      - Meta playbook validates variables and executes the target playbook.
      - Parses status.json written by meta playbook (includes summary with collected_info).
      - Triggers `ansible-navigator` via `systemd-run` using the configured execution environment.
      - Uses `--working-directory` parameter of systemd-run to set BASE_PATH (`/var/lib/cockpit-plugin-demos`) as the working directory, so ansible-navigator automatically mounts it into the execution environment.
      - Uses relative playbook path (`meta/meta_playbook.yml`) since execution happens from BASE_PATH.
      - Uses `ansible.cfg` in the meta directory which configures `collections_paths` to include `/var/lib/cockpit-plugin-demos/collections` along with standard paths.
      - Captures and streams command output to the web UI.

4.  **UI Components (PatternFly):**
    - **Settings:** Form to configure Collection Source (Git URL or Galaxy format), Execution Environment, and option to use locally installed collection.
      - Namespace and Collection Name fields should NOT be displayed in the form.
      - These values are automatically derived from the `MANIFEST.json` file in the collection repository after installation or when using local collections.
      - If namespace/collectionName are needed before installation (e.g., for Galaxy format `namespace.collection`), they can be parsed from the collectionSource field.
    - **Catalog Grid:** Cards displaying available demos from `demos.yaml` with playbook type badges and descriptions.
    - **Dynamic Launch Modal:**
      - Takes a `DemoDefinition`.
      - **Dynamically renders inputs** based on `parameters` array.
      - Displays parameter descriptions as helper text.
      - Uses `required` field for validation instead of checking default value.
      - Use `react-hook-form` or controlled state to capture values.
    - **Instance Detail Modal:**
      - Shows execution summary with collected_info from status.json.
      - Displays demo type badge.
    - **Instance List:** Polling `status.json` for deployment updates.

**demos.yaml Structure:**

The `demos.yaml` file must be located in the root of each collection (e.g., `collections/ansible_collections/{namespace}/{collection}/demos.yaml` or in standard Ansible collection paths) and must follow this structure:

```yaml
demos:
  - id: <unique-demo-id>
    name: <human-readable-name>
    description: <optional-description>
    type: playbook
    path: <relative-path-to-playbook>
    parameters:
      - name: <variable-name>
        label: <display-label>  # Optional
        description: <help-text-description>  # Optional
        type: text | number | boolean | select  # Required for validation
        required: true | false  # Required for validation
        default: <default-value>  # Optional
        options: [<for-select-type>]  # Required for select type
```

**Meta Playbook Pattern:**

The meta playbook (`/var/lib/cockpit-plugin-demos/meta/meta_playbook.yml`) validates variables and executes demos:
- Validates required variables are defined
- Validates variable types (text, number, boolean, select)
- Includes playbook based on demo_type
- Collects variable information for summary
- Writes status.json with summary including collected_info

**Ansible Configuration:**

The `ansible.cfg` file in `/var/lib/cockpit-plugin-demos/meta/` must be configured with multiple collection paths:
- `collections_paths = /var/lib/cockpit-plugin-demos/collections:~/.ansible/collections:/usr/share/ansible/collections`

This ensures ansible-navigator can access collections from both the plugin-specific directory and standard Ansible locations when executing playbooks.

**Status File Structure:**

```json
{
  "state": "pending" | "running" | "completed" | "failed",
  "message": "<status-message>",
  "startedAt": "<iso-timestamp>",
  "completedAt": "<iso-timestamp>",
  "error": "<error-message-if-failed>",
  "output": "<ansible-output>",
  "summary": {
    "collected_info": [
      {
        "description": "<description>",
        "name": "<variable-name>",
        "value": "<variable-value>"
      }
    ]
  }
}
```

**Constraints:**
- Use `cockpit.spawn` to execute `ansible-galaxy collection install` command in the execution environment when installing collections.
- Support loading collections from locally installed locations without requiring installation.
- Search for collections in multiple standard Ansible paths: plugin directory, user-specific (`~/.ansible/collections`), and system-wide (`/usr/share/ansible/collections`).
- Handle missing `demos.yaml` gracefully (show "Invalid Catalog" error).
- Handle missing collections gracefully (show appropriate error message).
- Ensure file paths used in `cockpit.file` are constructed safely.
- Validate demo type is 'playbook'.
- Handle YAML parsing errors in demos.yaml gracefully.
- Execution environment must have `ansible-galaxy` command available when installing collections.
- Collections directories must be mounted into execution environment when running ansible-navigator (handled automatically via `--collections-path` flags).